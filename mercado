#include <stdio.h>
#include <stdlib.h>

struct Produto{
	int cod;
	char nome[30];
	float preco;
	int qntEstq;
};

struct Carrinho{
	Produto produto; 
	int quantidade;
};

void cadastrarProduto(struct Produto produto[], int *qnt, int qntProd){
	int i;
	
	printf("Deseja cadastrar quantos produtos: ");
	scanf(" %d", &(*qnt));
	
	system("cls");
	
	for(i = 0; i < *qnt; i++){
		
		printf("-------------Cadastro de Produto-------------\n\n");
		
		printf("Digite o codigo do produto %d: ", i+1);
		scanf(" %d", &produto[i].cod);
		
		printf("Digite o nome do produto %d: ", i+1);
		scanf(" %50[^\n]", &produto[i].nome);
		
		printf("Digite o preco do produto %d: ", i+1);
		scanf(" %f", &produto[i].preco);
		
		printf("Digite a quantidade do produto %d em estoque: ", i+1);
		scanf(" %d", &produto[i].qntEstq);
		
		qntProd++;
		
		system("cls");
		
	}
	system("pause");
}

void listarProdutos(struct Produto produto[], int qnt){
	int i;
	
	printf("-------------Produtos Listados-------------\n\n");
	if(qnt != 0){
		for(i = 0; i < qnt; i++){		
			printf("Produto %d\n\n", i+1);
			
			printf("Codigo: %d\n", produto[i].cod);
			printf("Nome: %s\n", produto[i].nome);
			printf("Preco: %.2f\n", produto[i].preco);
			printf("Quantidade: %d\n", produto[i].qntEstq);
			printf("--------------------\n\n");
		}
	}else{
		printf("Nenhum produto foi cadastrado!");
	}
	system("pause");
	system("cls");
}

void comprarProduto(struct Produto produto[], struct Carrinho carrinho[], int qnt, int qntProd){
	int i;
	int j;
	int codProd = 0;
	int qntDesejada = 0;
	int prodEncontrado = 0;
	
	printf("Deseja comprar quantos produtos? ");
	scanf(" %d", &qnt);
	
	system("cls");
	for(i = 0; i < qntProd; i++){
		printf("Digite a o codigo do produto: ");
		scanf(" %d", &codProd);
		
		for(j = 0; j < qntProd; j++){
			if(produto[j].cod == codProd){
				
				prodEncontrado = 1;
				
				printf("Produto: %s\n", produto[j].nome);
                printf("Quantidade em estoque: %d\n", produto[j].qntEstq);
                printf("Digite a quantidade desejada: ");
                scanf("%d", &qntDesejada);
                system("cls");
 /*               
                if(qntDesejada <= produto[j].qntEstq){
                	produto[j].qntEstq -= qntDesejada;
                	
                	
                	printf("Produto adicionado ao carrinho!\n");
                	
				}
			if(produto[j].cod != codProd){
				printf("Produto nÃ£o encontrado!\n");
			}*/
			}
			prodEncontrado = 0;
		}
		
	}	
}
void menuPrincipal(struct Produto produto[], struct Carrinho carrinho[], int *qnt, int qntProd){
	
	int op;
	int sair = 0;
	
	while(sair == 0){
	
		printf("-------------MENU-------------\n\n");
		printf("1. Cadastrar Produto\n2. Listar Produtos\n3. Comprar Produto\n4. Vizualizar Carrinho\n5. Fechar Pedido\n6. Sair\n");
		scanf(" %d", &op);
		
		system("cls");
		switch(op){
			case 1:
				cadastrarProduto(produto, qnt, qntProd);
				break;
				
			case 2:
				listarProdutos(produto, *qnt);
				break;
			case 3:
				comprarProduto(produto, carrinho, *qnt, qntProd);
				break;
			case 6:
				printf("Ate a proxima!\n");
				sair++;
				break;
			default:
				printf("Opcao invalida!");
				break;
		}
	}
}

int main(void){

	struct Produto produto[50];
	struct Carrinho carrinho[50];
	int qnt = 0;
	int quantProd = 0;
	
	menuPrincipal(produto, carrinho, &qnt, quantProd);
	
	

	return 0;
}
